<!DOCTYPE html><html><head>    <meta charset="UTF-8"/>    <meta name="HandheldFriendly" content="True"/>    <meta name="viewport" content="width=device-width, initial-scale=1">    <meta http-equiv="cleartype" content="on"/>    <title></title>    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.css" />    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>    <script src="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.js"></script>    <script src="js/jquery.form.js"></script></head><body><div data-role="page">    <div data-role="header" data-position="fixed">        <h1>保养预约</h1>    </div><!-- /header -->    <div role="main" class="ui-content">        <form id="orderForm" action="/saveOrder" method="post" runat="server">            <input type="hidden" name="userId" id="textinput-1" value="{{userInfo._id}}">            <input type="text" name="username" id="textinput-2" disabled placeholder="您的称呼" value="{{userInfo.nickName}}">            <input type="number" name="miles" id="miles" pattern="[0-9]*"  placeholder="车辆里程" value="">            <label for="date">预约日期:</label>            <input type="date" name="orderDate" id="date">            <label for="select-choice-a" class="select">选择预约时间段：</label>            <select name="select-choice-a" id="select-choice-a">                <option value="1">9:00 - 11:00</option>                <option value="2">11:00 - 13:00</option>                <option value="3">13:00 - 15:00</option>                <option value="4">15:00 - 17:00</option>                <option value="5">17:00 - 19:00</option>                <option value="6">19:00 - 21:00</option>            </select>            <select id="selectCarBrand">                <option value="-1">请选择品牌</option>                {% for carBrand in carBrands %}                <option value="{{carBrand.id}}">{{carBrand.name}}</option>                {% endfor %}            </select>            <select id="selectCarSubBrand">            </select>            <select id="selectCarModel" name="carModel">            </select>            <label >保养价格：<span id="ourPrice" ></span></label>            <label >4S店价格：<span id="ssssPrice"></span></label>            <label >节    省：<span id="savePrice" style="color:#F00;"></span></label>            <a id="submit" href="javascript:void(0)" class="ui-btn ui-corner-all">提交订单</a>        </form>        <div id="submitContent" style="display:none">        </div>    </div><!-- /content -->    <script>        $(function() {            $('#selectCarSubBrand,#selectCarModel').css('display', 'none').parent('div').parent('.ui-select').css('display', 'none');            $('#selectCarBrand').bind('change', function() {                var subBrandSelector = $('#selectCarSubBrand');                subBrandSelector.val('');                if(subBrandSelector.prev().html()!='&nbsp;'){                    subBrandSelector.prev().html('&nbsp;');                }                //var defaultOption = subBrandSelector[0].options[0];                subBrandSelector.empty();                var selectCarModel = $('#selectCarModel');                //var defaultOption = subBrandSelector[0].options[0];                selectCarModel.val('');                if(selectCarModel.prev().html()!='&nbsp;'){                    selectCarModel.prev().html('&nbsp;');                }                selectCarModel.empty();                $.ajax({                    type : "POST",                    url  : "/getCarSubBrands",                    cache : false,                    data : {id:$(this).val()},                    success : function(data,result){                        $('#selectCarSubBrand').css('display', 'block').parent('div').parent('.ui-select').css('display', 'block');                       // subBrandSelector.append(defaultOption);                        for(var i= 0,subBrand;subBrand=data[i];i++){                            var option = new Option(subBrand.name,subBrand.id);                            subBrandSelector.append(option);                        }                    },                    error : function(){                    }                });                return false;            });            var carModelData = {};            $('#selectCarSubBrand').bind('change', function() {                var selectCarModel = $('#selectCarModel');                //var defaultOption = subBrandSelector[0].options[0];                selectCarModel.val('');                if(selectCarModel.prev().html()!='&nbsp;'){                    selectCarModel.prev().html('&nbsp;');                }                selectCarModel.empty();                var brandId = $('#selectCarBrand').val();                var subBrandId = $(this).val();                if(!brandId&&!subBrandId){                    alert('请选择品牌和车型');                    return false;                }                $.ajax({                    type : "POST",                    url  : "/getCarModel",                    cache : false,                    data : {brandId:$('#selectCarBrand').val(),subBrandId:$(this).val()},                    success : function(data,result){                        carModelData = {};                        $('#selectCarModel').css('display', 'block').parent('div').parent('.ui-select').css('display', 'block');                      //  subBrandSelector.append(defaultOption);                        for(var i= 0,subBrand;subBrand=data[i];i++){                            var option = new Option(subBrand.name,subBrand.id);                            selectCarModel.append(option);                            carModelData[subBrand.id] = subBrand;                        }                    },                    error : function(){                    }                });                return false;            });            $('#selectCarModel').bind('change', function() {                var modelId = $(this).val();                var model = carModelData[modelId];                $('#ourPrice').html(model.ourPrice);                $('#ssssPrice').html(model.ssssPrice);                $('#savePrice').html(model.ssssPrice-model.ourPrice);            });            $('#submit').click(function(){                    var options = {                        //target:'#Tip', //后台将把传递过来的值赋给该元素                        url:'/saveOrder', //提交给哪个执行                        type:'POST',                        success: function(data){                            $('#orderForm').hide();                            $('#submitContent').html(data).show();                        } //显示操作提示                    };                    $('#orderForm').ajaxSubmit(options);                });        });    </script></div><!-- /page --></body></html>